<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Edlib::Aligner
  
    &mdash; Documentation by YARD 0.9.37
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Edlib::Aligner";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (A)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Edlib.html" title="Edlib (module)">Edlib</a></span></span>
     &raquo; 
    <span class="title">Aligner</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Edlib::Aligner
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Edlib::Aligner</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/edlib.rb<span class="defines">,<br />
  ext/edlib/edlibext.c</span>
</dd>
  </dl>
  
</div>








  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#additional_equalities-instance_method" title="#additional_equalities (instance method)">#<strong>additional_equalities</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#additional_equalities=-instance_method" title="#additional_equalities= (instance method)">#<strong>additional_equalities=</strong>(equalities)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#align-instance_method" title="#align (instance method)">#<strong>align</strong>(query, target, nice: false)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#align_raw-instance_method" title="#align_raw (instance method)">#<strong>align_raw</strong>(query, target)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#config-instance_method" title="#config (instance method)">#<strong>config</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(k: -1,, mode: &#39;NW&#39;, task: &#39;DISTANCE&#39;, additional_equalities: nil)  &#x21d2; Aligner </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of Aligner.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#k-instance_method" title="#k (instance method)">#<strong>k</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#k=-instance_method" title="#k= (instance method)">#<strong>k=</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#mode-instance_method" title="#mode (instance method)">#<strong>mode</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#mode=-instance_method" title="#mode= (instance method)">#<strong>mode=</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#task-instance_method" title="#task (instance method)">#<strong>task</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#task=-instance_method" title="#task= (instance method)">#<strong>task=</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(k: -1,, mode: &#39;NW&#39;, task: &#39;DISTANCE&#39;, additional_equalities: nil)  &#x21d2; <tt><span class='object_link'><a href="" title="Edlib::Aligner (class)">Aligner</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a new instance of Aligner.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


7
8
9
10
11
12
13</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/edlib.rb', line 7</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='label'>k:</span> <span class='op'>-</span><span class='int'>1</span><span class='comma'>,</span> <span class='label'>mode:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NW</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>task:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DISTANCE</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>additional_equalities:</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_mode'>mode</span> <span class='op'>=</span> <span class='id identifier rubyid_mode'>mode</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='kw'>if</span> <span class='id identifier rubyid_mode'>mode</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>Symbol</span>
  <span class='id identifier rubyid_task'>task</span> <span class='op'>=</span> <span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='kw'>if</span> <span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>Symbol</span>
  <span class='id identifier rubyid_mode'>mode</span> <span class='op'>=</span> <span class='id identifier rubyid_mode'>mode</span><span class='period'>.</span><span class='id identifier rubyid_upcase'>upcase</span> <span class='kw'>if</span> <span class='id identifier rubyid_mode'>mode</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>String</span>
  <span class='id identifier rubyid_task'>task</span> <span class='op'>=</span> <span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_upcase'>upcase</span> <span class='kw'>if</span> <span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>String</span>
  <span class='id identifier rubyid_initialize_raw'>initialize_raw</span><span class='lparen'>(</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_mode'>mode</span><span class='comma'>,</span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_additional_equalities'>additional_equalities</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="additional_equalities-instance_method">
  
    #<strong>additional_equalities</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="additional_equalities=-instance_method">
  
    #<strong>additional_equalities=</strong>(equalities)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


329
330
331
332
333
334
335</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/edlib/edlibext.c', line 329</span>

static VALUE
aligner_set_additional_equalities(VALUE self, VALUE equalities)
{
	EdlibAlignConfig *config = aligner_get_config(self);
	EdlibEqualityPair *eqpairs = aligner_get_equalityPairs(self);
	return set_additional_equalities(config, eqpairs, equalities);
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="align-instance_method">
  
    #<strong>align</strong>(query, target, nice: false)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


15
16
17
18
19
20
21</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/edlib.rb', line 15</span>

<span class='kw'>def</span> <span class='id identifier rubyid_align'>align</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='comma'>,</span> <span class='id identifier rubyid_target'>target</span><span class='comma'>,</span> <span class='label'>nice:</span> <span class='kw'>false</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_nice'>nice</span>
    <span class='id identifier rubyid_align_nice'>align_nice</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='comma'>,</span> <span class='id identifier rubyid_target'>target</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_align_raw'>align_raw</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='comma'>,</span> <span class='id identifier rubyid_target'>target</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="align_raw-instance_method">
  
    #<strong>align_raw</strong>(query, target)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/edlib/edlibext.c', line 374</span>

static VALUE
aligner_align(VALUE self, VALUE query, VALUE target)
{
	EdlibAlignConfig *config = aligner_get_config(self);
	if (!config)
	{
		rb_raise(rb_eRuntimeError, &quot;config is NULL&quot;);
	}

	EdlibAlignResult result = edlibAlign(
			StringValueCStr(query),
			RSTRING_LEN(query),
			StringValueCStr(target),
			RSTRING_LEN(target),
			*config);

	if (result.status != 0)
	{
		rb_raise(rb_eRuntimeError, &quot;edlibAlign failed&quot;);
	}

	VALUE edit_distance = INT2NUM(result.editDistance);
	VALUE alphabet_length = INT2NUM(result.alphabetLength);
	VALUE locations = rb_ary_new();
	VALUE alignment = rb_ary_new();
	VALUE cigar;

	int *el = result.endLocations;
	int *sl = result.startLocations;
	for (int i = 0; i &lt; result.numLocations; i++)
	{
		VALUE ary = rb_ary_new();
		if (sl)
		{
			rb_ary_push(ary, INT2NUM(sl[i]));
		}
		else
		{
			rb_ary_push(ary, Qnil);
		}
		if (el)
		{
			rb_ary_push(ary, INT2NUM(el[i]));
		}
		else
		{
			rb_ary_push(ary, Qnil);
		}
		rb_ary_push(locations, ary);
	}

	for (int i = 0; i &lt; result.alignmentLength; i++)
	{
		rb_ary_push(alignment, UINT2NUM(result.alignment[i]));
	}

	char *ccigar = edlibAlignmentToCigar(result.alignment, result.alignmentLength, 1); // EDLIB_CIGAR_EXTENDED
	cigar = rb_str_new2(ccigar);
	free(ccigar);

	VALUE hash = rb_hash_new();
	rb_hash_aset(hash, ID2SYM(rb_intern(&quot;edit_distance&quot;)), edit_distance);
	rb_hash_aset(hash, ID2SYM(rb_intern(&quot;alphabet_length&quot;)), alphabet_length);
	rb_hash_aset(hash, ID2SYM(rb_intern(&quot;locations&quot;)), locations);
	rb_hash_aset(hash, ID2SYM(rb_intern(&quot;alignment&quot;)), alignment);
	rb_hash_aset(hash, ID2SYM(rb_intern(&quot;cigar&quot;)), cigar);

	edlibFreeAlignResult(result);

	return hash;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="config-instance_method">
  
    #<strong>config</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


337
338
339
340
341
342
343
344
345
346
347
348
349
350</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/edlib/edlibext.c', line 337</span>

static VALUE
aligner_config_hash(VALUE self)
{
	EdlibAlignConfig *config = aligner_get_config(self);

	VALUE hash = rb_hash_new();

	rb_hash_aset(hash, ID2SYM(rb_intern(&quot;k&quot;)), get_k(config));
	rb_hash_aset(hash, ID2SYM(rb_intern(&quot;mode&quot;)), get_mode(config));
	rb_hash_aset(hash, ID2SYM(rb_intern(&quot;task&quot;)), get_task(config));
	rb_hash_aset(hash, ID2SYM(rb_intern(&quot;additional_equalities&quot;)), get_additional_equalities(config));

	return hash;
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="k-instance_method">
  
    #<strong>k</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="k=-instance_method">
  
    #<strong>k=</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="mode-instance_method">
  
    #<strong>mode</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="mode=-instance_method">
  
    #<strong>mode=</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="task-instance_method">
  
    #<strong>task</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="task=-instance_method">
  
    #<strong>task=</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Sat Dec 28 09:54:56 2024 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.37 (ruby-3.4.1).
</div>

    </div>
  </body>
</html>